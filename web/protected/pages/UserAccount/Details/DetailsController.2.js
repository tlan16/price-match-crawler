var PageJs=new Class.create;
PageJs.prototype=Object.extend(new DetailsPageJs,{load:function(){var a;a=this;a._init();$(a.getHTMLID("itemDiv")).addClassName("row");a._getInputDiv("username",a._item.username||"",$(a._containerIds.username),null,!0)._getInputDiv("firstname",a._item.person?a._item.person.firstName:"",$(a._containerIds.firstname),null,!0)._getInputDiv("lastname",a._item.person?a._item.person.lastName:"",$(a._containerIds.lastname),null,!0)._getInputDiv("password","",$(a._containerIds.password),a._item.id?"New Password":
null,a._item.id?!1:!0)._getSaveBtn();a._item&&a._item.id&&a._disableAll($(a._containerIds.username));a._addNewComboBtn($(a._containerIds.new_store_roles));a._item.roles&&Array.isArray(a._item.roles)&&a._item.roles.each(function(d){a._addComboRow(d,$(a._containerIds.store_roles))});return a},_addNewComboBtn:function(a){var d,b,c,e;d=this;b=a||null;if(!b||!b.id)return d;c=(new Element("button",{"class":"newStoreBtn btn btn-primary btn-sm"})).update("New Access").observe("click",function(a){c.writeAttribute("disabled",
!0);b.insert({bottom:e=new Element("div")});d._signRandID(e);d._addComboRow(null,e);c.writeAttribute("disabled",!1)});b.update(d._getFormGroup("",c).addClassName("col-xs-12"));return d},_getComboRowDeleteBtn:function(a,d){var b,c,e,f,h,g;b=this;c=a||null;e=a?!0===a.active:!0;f=d||"";return h=(new Element("button",{"class":!0===e?"btn btn-sm btn-danger":"btn btn-sm btn-success"})).addClassName(f).setStyle("margin-bottom: 15px;").insert({bottom:new Element("i",{"class":!0===e?"glyphicon glyphicon-trash":
"glyphicon glyphicon-repeat"})}).observe("click",function(a){confirm("This "+(c?"":"newly added ")+"nutrition will be REMOVED, continue?")&&(g=h.up(".combo"),c&&c.id&&g.up().insert({bottom:new Element("input",{type:"hidden","save-item":"ignore_"+c.id,dirty:!0})}),g.remove(),b._refreshDirty()._getSaveBtn())})},_addComboRow:function(a,d){var b,c,e,f;b=a||null;c=d||null;if(!c||!c.id)return this;c.insert({bottom:(new Element("div",{"class":"combo col-xs-12",combo_id:b?b.id:"new",active:b?b.active:!0})).insert({bottom:(new Element("div",
{"class":"row "})).insert({bottom:c=new Element("div",{"class":"store col-md-7 col-sm-6 col-xs-12"})}).insert({bottom:e=new Element("div",{"class":"role col-md-4 col-sm-5  col-xs-12"})}).insert({bottom:(new Element("div",{"class":"pull-right text-right col-md-1 col-sm-1 col-xs-12"})).update(this._getComboRowDeleteBtn(b,"col-xs-12"))})})});this._getSelect2Div("Store","store",b&&b.store?{id:b.store.id,text:b.store.name,data:b.store}:null,c," ",!0,{multiple:!1,width:"100%",ajax:{delay:250,url:"/ajax/getAll",
type:"GET",data:function(a){return{searchTxt:"name like ?",searchParams:["%"+a+"%"],entityName:"Store",pageNo:1}},results:function(a,b,c){f=[];a.resultData&&a.resultData.items&&a.resultData.items.each(function(a){f.push({id:a.id,text:a.name,data:a})});return{results:f}}},cache:!0,escapeMarkup:function(a){return a}})._getSelect2Div("Role","role",b?{id:b.id,text:b.name,data:b}:null,e," ",!0,{multiple:!1,width:"100%",ajax:{delay:250,url:"/ajax/getAll",type:"GET",data:function(a){return{searchTxt:"name like ?",
searchParams:["%"+a+"%"],entityName:"Role",pageNo:1}},results:function(a,b,c){f=[];a.resultData&&a.resultData.items&&a.resultData.items.each(function(a){f.push({id:a.id,text:a.name,data:a})});return{results:f}}},cache:!0,escapeMarkup:function(a){return a}});return this},collectData:function(){var a,d,b;a=this;d=a._collectFormData($(a.getHTMLID("itemDiv")),"save-item");if(!d)return null;d.store_roles=[];$(a.getHTMLID("itemDiv")).getElementsBySelector(".combo[combo_id]").each(function(c){(b=a._collectFormData($(c),
"save-item"))&&d.store_roles.push(b)});return d}});